stages:
  - lint
  - build
  - test

variables:
  NG_CLI_IMAGE: "registry.hub.docker.com/trion/ng-cli-karma:latest"

ng-lint:
  stage: lint
  script:
    - npm ci
    - ng lint --force

ng-build:
  stage: build
  script:
    - npm ci
    - ng build --configuration=production

ng-test:
  stage: test
  script:
    - npm ci
    - ng test --code-coverage --reporters junit --watch=false --no-progress
  artifacts:
    reports:
      junit: reports/ng-test.xunit.xml
    paths:
      - reports/

sonarqube:
  stage: test
  script:
    - sonar-scanner
